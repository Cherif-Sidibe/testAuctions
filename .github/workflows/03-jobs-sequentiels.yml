# ========================================
# EXEMPLE 3 : JOBS SÉQUENTIELS
# ========================================
# Ce workflow montre comment exécuter des jobs
# les uns APRÈS les autres (séquentiellement)

name: 03 - Jobs Séquentiels

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  # ================
  # ÉTAPE 1 : Préparation
  # ================
  preparation:
    runs-on: ubuntu-latest

    steps:
      - name: Préparer l'environnement
        run: |
          echo " Préparation de l'environnement..."
          sleep 2
          echo " Environnement prêt !"

  # ================
  # ÉTAPE 2 : Construction
  # ================
  construction:
    runs-on: ubuntu-latest
    # Ce job attend que "preparation" soit terminé
    needs: preparation

    steps:
      - name: Construire le projet
        run: |
          echo " Construction en cours..."
          sleep 3
          echo " Construction réussie !"

  # ================
  # ÉTAPE 3 : Tests
  # ================
  tests:
    runs-on: ubuntu-latest
    # Ce job attend que "construction" soit terminé
    needs: construction

    steps:
      - name: Exécuter les tests
        run: |
          echo " Tests en cours..."
          sleep 2
          echo " Tests réussis !"

  # ================
  # ÉTAPE 4 : Déploiement
  # ================
  deploiement:
    runs-on: ubuntu-latest
    # Ce job attend que "tests" soit terminé
    needs: tests

    steps:
      - name: Déployer l'application
        run: |
          echo " Déploiement en cours..."
          sleep 2
          echo " Déploiement réussi !"

# ORDRE D'EXÉCUTION :
# 1. preparation
# 2. construction (attend preparation)
# 3. tests (attend construction)
# 4. deploiement (attend tests)
